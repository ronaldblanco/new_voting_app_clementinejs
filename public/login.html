<!DOCTYPE html>

<html>

	<head>
			<script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
		<script> 
    $(function(){
      $("#includedHead").load("/public/head.html"); 
    });
    </script> 
    <script> 
    $(function(){
      $("#includedLogo").load("/public/logo.html"); 
    });
    </script> 
    <script> 
    $(function(){
      $("#includedFoot").load("/public/foot.html"); 
    });
    </script> 
    <div id="includedHead"></div>
    
		<script src="/public/js/Chart.bundle.js"></script>
    	<script src="/public/js/utils.js"></script>
	</head>

	<body>
	    <div class="container">
	        <br>
			<div id="includedLogo"></div>
			
		</div>
		<div class="container">	
			<div class="login">
				
				<a href="/auth/twitter">
					<div class="btn" id="login-btn">
						<img src="/public/img/twitter_32.png" alt="github logo" />
						<p>LOGIN WITH TWITTER</p>
					</div>
				</a>
			</div>
		</div>
		<center>
			
		<div class = "container table-responsive" id = "publicPolls">
			<h3>Public Polls</h3>
			<button type="submit" class="btn btn-primary" id = "vote">Update Chart!</button>
			<button type="submit" class="btn btn-info" id = "back">Update Polls!</button>
			<table class="table table-bordered table-striped">
				<tr class="info">
					<td>
						<h4>POLLS</h4>
					</td>
					<td>
						<h4>OPTIONS FOR VOTE</h4>
					</td>
					<td>
						<h4>CHART STATE OF POLL</h4>
					</td>
				</tr>
				<tr class="active">
					<td>
						<ul id="publiclist">
						</ul>
					</td>
					<td>
						<ul id="publiclistOpt">
						</ul>
					</td>
					<td>
						<div id="canvas-holder">
        					<canvas id="chart-area" />
    					</div>
					</td>
				</tr>
			</table>
			
		</div
		
		
		
		</center>
		<script type="text/javascript" src="common/ajax-functions.js"></script>
		<script type="text/javascript" src="controllers/publicController.client.js"></script>
		
		<script>
		//function updateChart (data){
		/*var config = {
        type: 'pie',
        data: {
            datasets: [{
                data: [
                    randomScalingFactor(),
                    randomScalingFactor(),
                    randomScalingFactor(),
                    randomScalingFactor(),
                    randomScalingFactor(),
                ],
                backgroundColor: [
                    window.chartColors.red,
                    window.chartColors.orange,
                    window.chartColors.yellow,
                    window.chartColors.green,
                    window.chartColors.blue,
                ],
                label: 'Dataset 1'
            }],
            labels: [
                "Red",
                "Orange",
                "Yellow",
                "Green",
                "Blue"
            ]
        },
        options: {
            //responsive: true
            responsive: false
        }
    };*/
      
      window.onload = function() {
        var ctx = document.getElementById("chart-area").getContext("2d");
        window.myPie = new Chart(ctx, config);
    };

    document.getElementById('vote').addEventListener('click', function() {
    	var index = -1;
        config.data.datasets.forEach(function(dataset) {
            dataset.data = dataset.data.map(function() {
            	index++;
                return randomScalingFactorNew(mydata[index]);
            });
        });
        //config.data.datasets.data = mydata;
        config.data.datasets.backgroundColor = mybackcolors;
        config.data.labels = mylabels;

        
        /*function sleep(miliseconds) {
			var currentTime = new Date().getTime();

			while (currentTime + miliseconds >= new Date().getTime()) {
			}
		}
		sleep(1000);*/
        window.myPie.update();
    });

    var colorNames = Object.keys(window.chartColors);
    /*document.getElementById('addDataset').addEventListener('click', function() {
        var newDataset = {
            backgroundColor: [],
            data: [],
            label: 'New dataset ' + config.data.datasets.length,
        };

        for (var index = 0; index < config.data.labels.length; ++index) {
            newDataset.data.push(randomScalingFactor());

            var colorName = colorNames[index % colorNames.length];;
            var newColor = window.chartColors[colorName];
            newDataset.backgroundColor.push(newColor);
        }

        config.data.datasets.push(newDataset);
        window.myPie.update();
    });*/

    /*document.getElementById('removeDataset').addEventListener('click', function() {
        config.data.datasets.splice(0, 1);
        window.myPie.update();
    });*/
  // }
		</script>
		
		<center>
			<div id="includedFoot"></div>
		</center>
		
	</body>

</html>